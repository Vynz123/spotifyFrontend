

<!-- 
A simple HTML login form with a Login action when the button is pressed.  

The form triggers the login_user function defined in the JavaScript below when the Login button is pressed.
-->
<form action="javascript:login_user()">
    <p><label>
        User ID:
        <input type="text" name="uid" id="uid" required>
    </label></p>
    <p><label>
        Password:
        <input type="password" name="password" id="password" required>
    </label></p>
    <p>
        <button>Login</button>
    </p>
</form>

<!-- 
Below JavaScript code is designed to handle user authentication in a web application. It's written to work with a backend server that uses JWT (JSON Web Tokens) for authentication.

The script defines a function when the page loads. This function is triggered when the Login button in the HTML form above is pressed. 
 -->
<script type="module">
    function login_user(event) {

        console.log("asijdaijsd 2")
          event.preventDefault(); // Prevent the default form submission behavior
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "application/json");
          
          // Update the API endpoint to use port 8000
          const url = 'http://127.0.0.1:8000/api/users/authenticate';
          
          const body = {
              uid: document.getElementById("uid").value,
              password: document.getElementById("password").value,
          };
          
          const authOptions = {
              method: 'POST',
              cache: 'no-cache',
              headers: myHeaders,
              body: JSON.stringify(body)
          };
          
          fetch(url, authOptions)
          .then(response => {
              if (!response.ok) {
                  const errorMsg = 'Login error: ' + response.status;
                  console.log(errorMsg);
                  return;
              }
              window.location.href = "/_layouts/home1.html";
          })
          .catch(err => {
              console.error(err);
          });


          sessionStorage.setItem("log", true);
      }
      
      window.login_user = login_user;function login_user(event) {

        console.log("asijdaijsd 2")
          event.preventDefault(); // Prevent the default form submission behavior
          var myHeaders = new Headers();
          myHeaders.append("Content-Type", "application/json");
          
          // Update the API endpoint to use port 8000
          const url = 'http://127.0.0.1:8000/api/users/authenticate';
          
          const body = {
              uid: document.getElementById("uid").value,
              password: document.getElementById("password").value,
          };
          
          const authOptions = {
              method: 'POST',
              cache: 'no-cache',
              headers: myHeaders,
              body: JSON.stringify(body)
          };
          
          fetch(url, authOptions)
          .then(response => {
              if (!response.ok) {
                  const errorMsg = 'Login error: ' + response.status;
                  console.log(errorMsg);
                  return;
              }
              window.location.href = "/_layouts/home1.html";
          })
          .catch(err => {
              console.error(err);
          });


          sessionStorage.setItem("log", true);
      }
      
      window.login_user = login_user;
</script>